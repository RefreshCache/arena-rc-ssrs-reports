<?xml version="1.0" encoding="utf-8"?>
<Report xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2008/01/reportdefinition">
  <DataSources>
    <DataSource Name="ArenaDB">
      <DataSourceReference>ArenaDB</DataSourceReference>
      <rd:DataSourceID>db776bba-a92a-4497-8ba0-bb711e1f9585</rd:DataSourceID>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <DataSets>
    <DataSet Name="MainSource">
      <Fields>
        <Field Name="profile_id">
          <DataField>profile_id</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="profile_name">
          <DataField>profile_name</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="person_id">
          <DataField>person_id</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="last_name">
          <DataField>last_name</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="full_name">
          <DataField>full_name</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="custom_field_id">
          <DataField>custom_field_id</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="field_name">
          <DataField>field_name</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="field_value">
          <DataField>field_value</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="street_address_1">
          <DataField>street_address_1</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="street_address_2">
          <DataField>street_address_2</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="city">
          <DataField>city</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="state">
          <DataField>state</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="postal_code">
          <DataField>postal_code</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
      <Query>
        <DataSourceName>ArenaDB</DataSourceName>
        <CommandText>SELECT        cpro.profile_id, cpro.profile_name, cp.person_id, cp.last_name, cp.nick_name + ' ' + cp.last_name AS full_name, ccf.custom_field_id, ccf.title AS field_name, 
                         REPLACE(erf.selected_value, '^', ', ') AS field_value, cad.street_address_1, cad.street_address_2, cad.city, cad.state, cad.postal_code
FROM            evnt_registrant AS er LEFT OUTER JOIN
                         evnt_registrant_field AS erf ON erf.profile_id = er.profile_id AND erf.person_id = er.person_id LEFT OUTER JOIN
                         core_custom_field AS ccf ON ccf.custom_field_id = erf.custom_field_id INNER JOIN
                         core_profile AS cpro ON cpro.profile_id = er.profile_id INNER JOIN
                         core_person AS cp ON cp.person_id = er.person_id LEFT OUTER JOIN
                         core_person_address AS cpad ON cpad.person_id = cp.person_id AND cpad.primary_address = 'TRUE' LEFT OUTER JOIN
                         core_address AS cad ON cad.address_id = cpad.address_id
WHERE        (cpro.profile_id IN (@tag)) AND (ccf.custom_field_id IN (@custField) OR
                         ccf.custom_field_id = '-1') OR
                         (cpro.profile_id IN (@tag)) AND (ccf.custom_field_id IN (@custFieldModule)) OR
                         (cpro.profile_id IN (@tag)) AND (ccf.custom_field_id = '-1')</CommandText>
        <QueryParameters>
          <QueryParameter Name="@tag">
            <Value>=Parameters!tag.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@custField">
            <Value>=Parameters!custField.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@custFieldModule">
            <Value>=Parameters!custFieldModule.Value</Value>
          </QueryParameter>
        </QueryParameters>
      </Query>
    </DataSet>
    <DataSet Name="CustFieldSource">
      <Fields>
        <Field Name="custom_field_id">
          <DataField>custom_field_id</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="title">
          <DataField>title</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
      <Query>
        <DataSourceName>ArenaDB</DataSourceName>
        <CommandText>SELECT        '-1' AS custom_field_id, 'None' AS title
UNION ALL
SELECT        ccf.custom_field_id, ccf.title
FROM            core_custom_field AS ccf INNER JOIN
                         evnt_field AS ef ON ef.custom_field_id = ccf.custom_field_id
WHERE        (ef.profile_id IN (@tag))</CommandText>
        <QueryParameters>
          <QueryParameter Name="@tag">
            <Value>=Parameters!tag.Value</Value>
          </QueryParameter>
        </QueryParameters>
      </Query>
    </DataSet>
    <DataSet Name="TagSource">
      <Fields>
        <Field Name="Name">
          <DataField>Name</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="profile_id">
          <DataField>profile_id</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
      </Fields>
      <Query>
        <DataSourceName>ArenaDB</DataSourceName>
        <CommandText>with profiletree (
				  Root
				, Parent
				, Name
				, Level
				, ID
				, Branch)  as
(select 
	profiles.profile_name as Root
  , cast('' as varchar(100)) as Parent
  , profiles.profile_name as Name
  , cast('0' as int) as Level
  , profiles.profile_id as ID
  , cast(profiles.profile_id as varchar) as Branch
 from 
	core_profile as profiles 
 where 
	profiles.parent_profile_id is null
AND profiles.profile_type =4
union all
 select 
	tree.Root
  , tree.Name as Parent
  , CONVERT(VARCHAR(100),(replicate('-',tree.level+1))+profiles.profile_name) as Name
  , tree.Level + 1
  , profiles.profile_id
  , cast(tree.Branch + '.' + cast(profiles.profile_id as varchar) as varchar) 
 from 
	core_profile as profiles 
	inner join profiletree as tree 
		on profiles.parent_profile_id =  tree.id)

select 
Name

  , ID AS profile_id

from 
	profiletree as PT
order by 
	Root
  , branch</CommandText>
        <rd:UseGenericDesigner>true</rd:UseGenericDesigner>
      </Query>
    </DataSet>
    <DataSet Name="CustFieldModule">
      <Fields>
        <Field Name="custom_field_id">
          <DataField>custom_field_id</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="title">
          <DataField>title</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
      <Query>
        <DataSourceName>ArenaDB</DataSourceName>
        <CommandText>SELECT        '-1' AS custom_field_id, 'None' AS title
UNION ALL
SELECT        ccf.custom_field_id, ccf.title
FROM            core_custom_field AS ccf INNER JOIN
                         core_custom_field_module_field AS ccfmf ON ccf.custom_field_id = ccfmf.custom_field_id INNER JOIN
                         evnt_field_module AS efm ON ccfmf.custom_field_module_id = efm.custom_field_module_id
WHERE        (efm.profile_id IN (@tag))</CommandText>
        <QueryParameters>
          <QueryParameter Name="@tag">
            <Value>=Parameters!tag.Value</Value>
          </QueryParameter>
        </QueryParameters>
      </Query>
    </DataSet>
  </DataSets>
  <Body>
    <ReportItems>
      <Tablix Name="list1">
        <TablixBody>
          <TablixColumns>
            <TablixColumn>
              <Width>7.25in</Width>
            </TablixColumn>
          </TablixColumns>
          <TablixRows>
            <TablixRow>
              <Height>1.125in</Height>
              <TablixCells>
                <TablixCell>
                  <CellContents>
                    <Rectangle Name="list1_Contents">
                      <ReportItems>
                        <Textbox Name="profile_name">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=First(Fields!profile_name.Value)</Value>
                                  <Style>
                                    <FontSize>12pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>profile_name</rd:DefaultName>
                          <Top>0.125in</Top>
                          <Left>0.125in</Left>
                          <Height>0.25in</Height>
                          <Width>3.75in</Width>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <Tablix Name="matrix1">
                          <TablixCorner>
                            <TablixCornerRows>
                              <TablixCornerRow>
                                <TablixCornerCell>
                                  <CellContents>
                                    <Textbox Name="textbox1">
                                      <CanGrow>true</CanGrow>
                                      <KeepTogether>true</KeepTogether>
                                      <Paragraphs>
                                        <Paragraph>
                                          <TextRuns>
                                            <TextRun>
                                              <Value />
                                              <Style />
                                            </TextRun>
                                          </TextRuns>
                                          <Style />
                                        </Paragraph>
                                      </Paragraphs>
                                      <rd:DefaultName>textbox1</rd:DefaultName>
                                      <ZIndex>3</ZIndex>
                                      <Style>
                                        <PaddingLeft>2pt</PaddingLeft>
                                        <PaddingRight>2pt</PaddingRight>
                                        <PaddingTop>2pt</PaddingTop>
                                        <PaddingBottom>2pt</PaddingBottom>
                                      </Style>
                                    </Textbox>
                                  </CellContents>
                                </TablixCornerCell>
                              </TablixCornerRow>
                            </TablixCornerRows>
                          </TablixCorner>
                          <TablixBody>
                            <TablixColumns>
                              <TablixColumn>
                                <Width>1.125in</Width>
                              </TablixColumn>
                            </TablixColumns>
                            <TablixRows>
                              <TablixRow>
                                <Height>0.25in</Height>
                                <TablixCells>
                                  <TablixCell>
                                    <CellContents>
                                      <Textbox Name="field_value">
                                        <CanGrow>true</CanGrow>
                                        <KeepTogether>true</KeepTogether>
                                        <Paragraphs>
                                          <Paragraph>
                                            <TextRuns>
                                              <TextRun>
                                                <Value>=First(Fields!field_value.Value)</Value>
                                                <Style />
                                              </TextRun>
                                            </TextRuns>
                                            <Style />
                                          </Paragraph>
                                        </Paragraphs>
                                        <rd:DefaultName>field_value</rd:DefaultName>
                                        <Style>
                                          <BackgroundColor>=IIF(Code.bgColor=1, "Gainsboro","White")</BackgroundColor>
                                          <PaddingLeft>2pt</PaddingLeft>
                                          <PaddingRight>2pt</PaddingRight>
                                          <PaddingTop>2pt</PaddingTop>
                                          <PaddingBottom>2pt</PaddingBottom>
                                        </Style>
                                      </Textbox>
                                    </CellContents>
                                    <DataElementOutput>Output</DataElementOutput>
                                  </TablixCell>
                                </TablixCells>
                              </TablixRow>
                            </TablixRows>
                          </TablixBody>
                          <TablixColumnHierarchy>
                            <TablixMembers>
                              <TablixMember>
                                <Group Name="matrix1_field_name">
                                  <GroupExpressions>
                                    <GroupExpression>=Fields!custom_field_id.Value</GroupExpression>
                                  </GroupExpressions>
                                </Group>
                                <SortExpressions>
                                  <SortExpression>
                                    <Value>=Fields!custom_field_id.Value</Value>
                                  </SortExpression>
                                </SortExpressions>
                                <TablixHeader>
                                  <Size>0.25in</Size>
                                  <CellContents>
                                    <Textbox Name="field_name">
                                      <CanGrow>true</CanGrow>
                                      <KeepTogether>true</KeepTogether>
                                      <Paragraphs>
                                        <Paragraph>
                                          <TextRuns>
                                            <TextRun>
                                              <Value>=Fields!field_name.Value</Value>
                                              <Style>
                                                <FontWeight>Bold</FontWeight>
                                              </Style>
                                            </TextRun>
                                          </TextRuns>
                                          <Style />
                                        </Paragraph>
                                      </Paragraphs>
                                      <rd:DefaultName>field_name</rd:DefaultName>
                                      <ZIndex>2</ZIndex>
                                      <Style>
                                        <PaddingLeft>2pt</PaddingLeft>
                                        <PaddingRight>2pt</PaddingRight>
                                        <PaddingTop>2pt</PaddingTop>
                                        <PaddingBottom>2pt</PaddingBottom>
                                      </Style>
                                    </Textbox>
                                  </CellContents>
                                </TablixHeader>
                                <DataElementOutput>Output</DataElementOutput>
                              </TablixMember>
                            </TablixMembers>
                          </TablixColumnHierarchy>
                          <TablixRowHierarchy>
                            <TablixMembers>
                              <TablixMember>
                                <Group Name="matrix1_full_name">
                                  <GroupExpressions>
                                    <GroupExpression>=Fields!person_id.Value</GroupExpression>
                                  </GroupExpressions>
                                </Group>
                                <SortExpressions>
                                  <SortExpression>
                                    <Value>=Fields!last_name.Value</Value>
                                  </SortExpression>
                                </SortExpressions>
                                <TablixHeader>
                                  <Size>2.125in</Size>
                                  <CellContents>
                                    <Textbox Name="full_name">
                                      <CanGrow>true</CanGrow>
                                      <KeepTogether>true</KeepTogether>
                                      <Paragraphs>
                                        <Paragraph>
                                          <TextRuns>
                                            <TextRun>
                                              <Value>=Fields!full_name.Value
	+iif(Fields!street_address_1.Value=Nothing,""
	,vbCrLf+Fields!street_address_1.Value
	+iif(Fields!street_address_2.Value=Nothing,""
	,vbCrLf+Fields!street_address_2.Value)
	+iif((Fields!city.Value=Nothing AND Fields!state.Value=Nothing AND Fields!postal_code.Value=Nothing),""
	,vbCrLf
	+iif(Fields!city.Value=Nothing,""
	,Fields!city.Value+", ")
	+iif(Fields!state.Value=Nothing,""
	,Fields!state.Value+" ")
	+Fields!postal_code.Value))</Value>
                                              <Style />
                                            </TextRun>
                                          </TextRuns>
                                          <Style />
                                        </Paragraph>
                                      </Paragraphs>
                                      <rd:DefaultName>full_name</rd:DefaultName>
                                      <ZIndex>1</ZIndex>
                                      <Style>
                                        <BackgroundColor>=IIF(Code.alternateColor(), "Gainsboro","White")</BackgroundColor>
                                        <PaddingLeft>2pt</PaddingLeft>
                                        <PaddingRight>2pt</PaddingRight>
                                        <PaddingTop>2pt</PaddingTop>
                                        <PaddingBottom>2pt</PaddingBottom>
                                      </Style>
                                    </Textbox>
                                  </CellContents>
                                </TablixHeader>
                                <DataElementOutput>Output</DataElementOutput>
                              </TablixMember>
                            </TablixMembers>
                          </TablixRowHierarchy>
                          <RepeatColumnHeaders>true</RepeatColumnHeaders>
                          <RepeatRowHeaders>true</RepeatRowHeaders>
                          <Top>0.5in</Top>
                          <Left>0.125in</Left>
                          <Height>0.5in</Height>
                          <Width>3.25in</Width>
                          <ZIndex>1</ZIndex>
                          <Style />
                        </Tablix>
                      </ReportItems>
                      <KeepTogether>true</KeepTogether>
                      <Style />
                    </Rectangle>
                  </CellContents>
                </TablixCell>
              </TablixCells>
            </TablixRow>
          </TablixRows>
        </TablixBody>
        <TablixColumnHierarchy>
          <TablixMembers>
            <TablixMember />
          </TablixMembers>
        </TablixColumnHierarchy>
        <TablixRowHierarchy>
          <TablixMembers>
            <TablixMember>
              <Group Name="list1_Details_Group">
                <GroupExpressions>
                  <GroupExpression>=Fields!profile_id.Value</GroupExpression>
                </GroupExpressions>
                <PageBreak>
                  <BreakLocation>Between</BreakLocation>
                </PageBreak>
              </Group>
              <DataElementOutput>Output</DataElementOutput>
              <KeepTogether>true</KeepTogether>
            </TablixMember>
          </TablixMembers>
        </TablixRowHierarchy>
        <DataSetName>MainSource</DataSetName>
        <PageBreak>
          <BreakLocation>End</BreakLocation>
        </PageBreak>
        <Left>0.125in</Left>
        <Height>1.125in</Height>
        <Width>7.25in</Width>
        <Style />
      </Tablix>
    </ReportItems>
    <Height>3in</Height>
    <Style />
  </Body>
  <ReportParameters>
    <ReportParameter Name="tag">
      <DataType>Integer</DataType>
      <Prompt>Tag(s)</Prompt>
      <ValidValues>
        <DataSetReference>
          <DataSetName>TagSource</DataSetName>
          <ValueField>profile_id</ValueField>
          <LabelField>Name</LabelField>
        </DataSetReference>
      </ValidValues>
      <MultiValue>true</MultiValue>
    </ReportParameter>
    <ReportParameter Name="custField">
      <DataType>Integer</DataType>
      <DefaultValue>
        <Values>
          <Value>-1</Value>
        </Values>
      </DefaultValue>
      <Prompt>Custom Field(s)</Prompt>
      <ValidValues>
        <DataSetReference>
          <DataSetName>CustFieldSource</DataSetName>
          <ValueField>custom_field_id</ValueField>
          <LabelField>title</LabelField>
        </DataSetReference>
      </ValidValues>
      <MultiValue>true</MultiValue>
    </ReportParameter>
    <ReportParameter Name="custFieldModule">
      <DataType>Integer</DataType>
      <DefaultValue>
        <Values>
          <Value>-1</Value>
        </Values>
      </DefaultValue>
      <Prompt>Custom Module Field (s)</Prompt>
      <ValidValues>
        <DataSetReference>
          <DataSetName>CustFieldModule</DataSetName>
          <ValueField>custom_field_id</ValueField>
          <LabelField>title</LabelField>
        </DataSetReference>
      </ValidValues>
      <MultiValue>true</MultiValue>
    </ReportParameter>
  </ReportParameters>
  <Code>Dim Public bgColor As Integer = 0

Public Function alternateColor As Integer
If bgColor = 0
bgColor = 1
return bgColor
else
bgColor = 0
return bgColor
end if
End Function</Code>
  <Width>7.5in</Width>
  <Page>
    <InteractiveHeight>10in</InteractiveHeight>
    <InteractiveWidth>7.5in</InteractiveWidth>
    <LeftMargin>0.5in</LeftMargin>
    <RightMargin>0.5in</RightMargin>
    <TopMargin>0.5in</TopMargin>
    <BottomMargin>0.5in</BottomMargin>
    <Style />
  </Page>
  <Language>en-US</Language>
  <ConsumeContainerWhitespace>true</ConsumeContainerWhitespace>
  <rd:ReportID>6d04408b-8ca3-42ec-96a3-f94c799ae264</rd:ReportID>
  <rd:ReportUnitType>Inch</rd:ReportUnitType>
</Report>